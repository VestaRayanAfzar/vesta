# vesta
**[Vesta Rayan Afzar](http://vestarayanafzar.com) Platform**

## Installation
    npm install -g vesta
**Attention:** For full application lifecycle management (source control, deploy, and backup) the Docker (engine & compose) must be installed.  
On Windows and MAC OS these commands must be run from docker terminal.

## Technologies and Frameworks
* Docker
* Git
* CommonJS
* ExpressJS
* TypeScript
* Sass
* Gulp
* Browserify
* Angular
* Material design
* Ionic framework

## Commands

### `vesta init`
This command is used to initiate your dedicated server or VPS by:
* `vesta init docker`: Installing docker engine
* `vesta init docker-compose`: Installing docker-compose

### `vesta create (group/project | project)`
After asking a series of questions the project will be generated by cloning one of the followings:
* Server side
  * [expressJsTemplate](https://github.com/hbtb/expressJsTemplate)
* Client side
  * [materialWebTemplate](https://github.com/hbtb/materialWebTemplate)
  * [ionicCordovaTemplate](https://github.com/hbtb/ionicCordovaTemplate)

All these project are common in some files which are exported to a new project ([commonCodeTemplate](https://github.com/hbtb/commonCodeTemplate)) 
which will be copied/submoduled  into a sub directory of generated project.

If you want to init git repository you have to create them on your remote git repository server before using `vesta create`. 
The most important repository is the commonCode repository. 

### `vesta gen (sass | model | controller | directive | filter) name`
Generate each of the mentioned
* **sass** `vesta gen sass (font|component|directive|page) name`
* **model** `vesta gen model name` Creates a model step by step by asking several questions
* **controller** `vesta gen controller name` Based on the type of project this will generate a server side (express) or 
    client side (angular) controller
* **directive** `vesta gen directive name` Generates an angular directive
* **filter** `vesta gen filter name` Generates an angular filter

### `vesta update`
This command will update all `vesta-*` packages that are installed in your project and listed in `package.json`
* `vesta update` will only update all vesta packages
* `vesta update all` will update all packages mentioned at `dependencies` 
* `vesta update all dev` will update all packages mentioned at `devDependencies` 

### `vesta deploy (httpGitRepository | previousDeployConfigFile) [ext params]`<sup>1</sup>
After asking `username` and `password` the deploy process starts.
Deploy process Will move `resources/ci/deploy.sh` file to the project's root directory and  execute it.
These npm modules should be installed globally on the deploy server: `gulp-cli`,`typescript`.

Any `ext params` of any kind provided to the commend will be passed to `deploy.sh` script respectively after `CLONE_PATH` and `DEPLOY_PATH`,
 so it will be like `/path/to/deploy.sh CLONE_PATH DEPLY_PATH ext params`

### `vesta backup [previousDeployConfigFile]`
This will mount all volumes of this project into a _busybox_ image and then export (`docker export`) them into a tar file 
named `backup_yyyymmdd-hhmmss.tar`. The container will be removed after all.   

If `vesta backup` command is used (without any fileName), the vesta will look for `docker-compose.yml` file in current 
directory. If it's found based on the volumes on the compose file the backup tar file will be created, otherwise it will
log an error.

_**WARNING!**_ mount volumes will be merged into a single `busybox` container, so if there are more than one directory with
the same path inside -even different- containers, they will be merged together. 

1) `previousDeployConfigFile` is the path to the json file generated by `vesta deploy` command